{
    "id": "org.freedesktop.LinuxAudio.Lv2Plugins.ZynAddSubFx",
    "branch": "19.08",
    "runtime": "org.freedesktop.LinuxAudio.BaseExtension",
    "runtime-version": "19.08",
    "sdk": "org.freedesktop.Sdk",
    "build-extension": true,
    "appstream-compose": false,
    "build-options": {
        "prefix": "/app/extensions/Lv2Plugins/ZynAddSubFx",
        "prepend-pkg-config-path": "/app/extensions/Lv2Plugins/ZynAddSubFx/lib/pkgconfig",
        "prepend-ld-library-path": "/app/extensions/Lv2Plugins/ZynAddSubFx/lib"
    },
    "modules": [
        {
            "name": "ntk",
            "buildsystem": "simple",
            "build-commands": [
                "python3 ./waf configure --prefix=${FLATPAK_DEST} --libdir=lib",
                "python3 ./waf",
                "python3 ./waf install"
            ],
            "cleanup": [
                "/lib",
                "/include",
                "/bin"
            ],
            "post-install": [
                "rm ${FLATPAK_DEST}/lib/*.so*"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "git://git.tuxfamily.org/gitroot/non/fltk.git",
                    /* ~1.3.1000 */
                    "commit": "dae177189b12f74ea01ac2389b76326c06d9be78"
                },
                {
                    /* build the tools statically as they might be needed to build */
                    "type": "patch",
                    "path": "patches/ntk-static.patch"
                }
            ]
        },
        {
            "name": "mxml",
            "cleanup": [
                "/bin",
                "/include",
                "/lib/pkgconfig",
                "/share/doc",
                "/share/man",
                "*.so",
                "*.a"
            ],
            "build-options": {
                "env": {
                    "CFLAGS": "-fPIC"
                }
            },
            "config-opts": [
                "--disable-shared"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/michaelrsweet/mxml/releases/download/v2.12/mxml-2.12.tar.gz",
                    "sha256": "6bfb53baa1176e916855bd3b6d592fd5b962c3c259aacdb5670d90c57ce4034f"
                }
            ]
        },
        "shared-modules/linux-audio/liblo-static.json",
        {
            "name": "zynsubfx",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DPluginLibDir=${FLATPAK_DEST}"
            ],
            "build-options": {
                "env": {
                    "PREFIX": "${FLATPAK_DEST}",
                    "LDFLAGS": "-lm"
                }
            },
            "cleanup": [
                "/vst"
            ],
            "post-install": [
                "install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo org.freedesktop.LinuxAudio.Lv2Plugins.ZynAddSubFx.metainfo.xml",
                "appstream-compose --basename=org.freedesktop.LinuxAudio.Lv2Plugins.ZynAddSubFx --prefix=${FLATPAK_DEST} --origin=flatpak org.freedesktop.LinuxAudio.Lv2Plugins.ZynAddSubFx",
                "install -Dm644 -t $FLATPAK_DEST/share/licenses/zynsubfx COPYING"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.sourceforge.net/sourceforge/zynaddsubfx/zynaddsubfx/3.0.5/zynaddsubfx-3.0.5.tar.bz2",
                    "sha256": "7447322268114a1e0ac5f281ac37a09a78e761a7be61999caf79100049789f63"
                },
                {
                    "type": "patch",
                    "path": "patches/zynaddsubfx-ntk-static.patch"
                },
                {
                    "type": "file",
                    "path": "org.freedesktop.LinuxAudio.Lv2Plugins.ZynAddSubFx.metainfo.xml"
                }
            ]
        }
    ]
}
